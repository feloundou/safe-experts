Warning: Log dir /home/tyna/Documents/safe-experts/data/valor-anonymous-expert/valor-anonymous-expert_s0 already exists! Storing info there anyway.
here is the output file:  <_io.TextIOWrapper name='/home/tyna/Documents/safe-experts/data/valor-anonymous-expert/valor-anonymous-expert_s0/progress.txt' mode='w' encoding='UTF-8'>
[32;1mLogging data to /home/tyna/Documents/safe-experts/data/valor-anonymous-expert/valor-anonymous-expert_s0/progress.txt[0m
[36;1mSaving config:
[0m
{
    "ac_kwargs":	{
        "hidden_dims":	[
            128,
            128
        ]
    },
    "actor_critic":	"ActorCritic",
    "clip_ratio":	0.2,
    "composite_name":	"new_valor_penalized_standard",
    "con_dim":	10,
    "config_name":	"standard",
    "cost_lim":	50,
    "dc_kwargs":	{
        "hidden_dims":	[
            128,
            128
        ]
    },
    "dc_lr":	0.0005,
    "disc":	"ValorDiscriminator",
    "env_fn":	"<function <lambda> at 0x7fed1e560550>",
    "episodes_per_epoch":	5,
    "epochs":	1000,
    "exp_name":	"valor-anonymous-expert",
    "gamma":	0.99,
    "k":	1,
    "lam":	0.97,
    "logger":	{
        "<utils.EpochLogger object at 0x7fed9fa6a3a0>":	{
            "epoch_dict":	{},
            "exp_name":	"valor-anonymous-expert",
            "first_row":	true,
            "log_current_row":	{},
            "log_headers":	[],
            "output_dir":	"/home/tyna/Documents/safe-experts/data/valor-anonymous-expert/valor-anonymous-expert_s0",
            "output_file":	{
                "<_io.TextIOWrapper name='/home/tyna/Documents/safe-experts/data/valor-anonymous-expert/valor-anonymous-expert_s0/progress.txt' mode='w' encoding='UTF-8'>":	{
                    "mode":	"w"
                }
            }
        }
    },
    "logger_kwargs":	{
        "exp_name":	"valor-anonymous-expert",
        "output_dir":	"/home/tyna/Documents/safe-experts/data/valor-anonymous-expert/valor-anonymous-expert_s0"
    },
    "max_ep_len":	1000,
    "penalty_init":	1.0,
    "penalty_lr":	0.005,
    "pi_lr":	0.0003,
    "save_freq":	10,
    "seed":	0,
    "train_dc_interv":	10,
    "train_dc_iters":	10,
    "train_pi_iters":	1,
    "train_v_iters":	80,
    "vf_lr":	0.001
}
/home/tyna/.local/lib/python3.8/site-packages/gym/logger.py:30: UserWarning: [33mWARN: Box bound precision lowered by casting to float32[0m
  warnings.warn(colorize('%s: %s'%('WARN', msg % args), 'yellow'))
[32;1m
Number of parameters: 	 pi: 25860, 	 v: 25729, 	 d: 25610
[0m
context distribution: Categorical(logits: torch.Size([10]))
context sample:  tensor(0)
LABEL:  tensor([1])
GROUND TRUTH:  tensor([[0.]])
context sample:  tensor(1)
LABEL:  tensor([9])
GROUND TRUTH:  tensor([[1.]])
context sample:  tensor(8)
LABEL:  tensor([0])
GROUND TRUTH:  tensor([[8.]])
context sample:  tensor(9)
LABEL:  tensor([3])
GROUND TRUTH:  tensor([[9.]])
context sample:  tensor(2)
LABEL:  tensor([2])
GROUND TRUTH:  tensor([[2.]])
policy pull
value function pull
logging changes
---------------------------------------
|             Epoch |               0 |
|      AverageEpRet |           0.145 |
|          StdEpRet |           0.898 |
|          MaxEpRet |            1.54 |
|          MinEpRet |           -0.79 |
|     AverageEpCost |              33 |
|         StdEpCost |            42.8 |
|         MaxEpCost |             105 |
|         MinEpCost |               0 |
|             EpLen |           1e+03 |
|      AverageVVals |          -0.131 |
|          StdVVals |           0.273 |
|          MaxVVals |           0.418 |
|          MinVVals |          -0.525 |
| TotalEnvInteracts |           5e+03 |
|            LossPi |        1.49e+07 |
|       DeltaLossPi |       -1.49e+07 |
|             LossV |            13.2 |
|        DeltaLossV |           -8.98 |
|            LossDC |               0 |
|       DeltaLossDC |               0 |
|                KL |         0.00987 |
|              Time |            11.3 |
---------------------------------------
context sample:  tensor(2)
LABEL:  tensor([5])
GROUND TRUTH:  tensor([[2.]])
context sample:  tensor(6)
LABEL:  tensor([2])
GROUND TRUTH:  tensor([[6.]])
context sample:  tensor(8)
LABEL:  tensor([9])
GROUND TRUTH:  tensor([[8.]])
context sample:  tensor(1)
LABEL:  tensor([3])
GROUND TRUTH:  tensor([[1.]])
context sample:  tensor(3)
LABEL:  tensor([0])
GROUND TRUTH:  tensor([[3.]])
policy pull
value function pull
logging changes
---------------------------------------
|             Epoch |               1 |
|      AverageEpRet |          -0.341 |
|          StdEpRet |           0.291 |
|          MaxEpRet |           0.129 |
|          MinEpRet |          -0.659 |
|     AverageEpCost |            57.6 |
|         StdEpCost |            91.4 |
|         MaxEpCost |             236 |
|         MinEpCost |               0 |
|             EpLen |           1e+03 |
|      AverageVVals |           -1.82 |
|          StdVVals |            2.64 |
|          MaxVVals |            5.63 |
|          MinVVals |           -8.74 |
| TotalEnvInteracts |           1e+04 |
|            LossPi |        2.32e+06 |
|       DeltaLossPi |       -2.32e+06 |
|             LossV |            25.2 |
|        DeltaLossV |           -22.7 |
|            LossDC |               0 |
|       DeltaLossDC |               0 |
|                KL |         0.00439 |
|              Time |            21.9 |
---------------------------------------
context sample:  tensor(9)
LABEL:  tensor([9])
GROUND TRUTH:  tensor([[9.]])
context sample:  tensor(0)
LABEL:  tensor([4])
GROUND TRUTH:  tensor([[0.]])
context sample:  tensor(1)
LABEL:  tensor([9])
GROUND TRUTH:  tensor([[1.]])
context sample:  tensor(2)
LABEL:  tensor([5])
GROUND TRUTH:  tensor([[2.]])
context sample:  tensor(9)
LABEL:  tensor([9])
GROUND TRUTH:  tensor([[9.]])
policy pull
value function pull
logging changes
---------------------------------------
|             Epoch |               2 |
|      AverageEpRet |          -0.147 |
|          StdEpRet |           0.971 |
|          MaxEpRet |            1.73 |
|          MinEpRet |           -0.97 |
|     AverageEpCost |             160 |
|         StdEpCost |             144 |
|         MaxEpCost |             398 |
|         MinEpCost |               0 |
|             EpLen |           1e+03 |
|      AverageVVals |           -1.94 |
|          StdVVals |            3.28 |
|          MaxVVals |            2.91 |
|          MinVVals |           -11.8 |
| TotalEnvInteracts |         1.5e+04 |
|            LossPi |        3.52e+10 |
|       DeltaLossPi |       -3.52e+10 |
|             LossV |              78 |
|        DeltaLossV |           -70.3 |
|            LossDC |               0 |
|       DeltaLossDC |               0 |
|                KL |         0.00336 |
|              Time |            32.7 |
---------------------------------------
context sample:  tensor(4)
LABEL:  tensor([9])
GROUND TRUTH:  tensor([[4.]])
context sample:  tensor(5)
LABEL:  tensor([0])
GROUND TRUTH:  tensor([[5.]])
context sample:  tensor(8)
LABEL:  tensor([7])
GROUND TRUTH:  tensor([[8.]])
context sample:  tensor(4)
LABEL:  tensor([2])
GROUND TRUTH:  tensor([[4.]])
context sample:  tensor(0)
LABEL:  tensor([1])
GROUND TRUTH:  tensor([[0.]])
policy pull
value function pull
logging changes
---------------------------------------
|             Epoch |               3 |
|      AverageEpRet |          -0.218 |
|          StdEpRet |           0.469 |
|          MaxEpRet |           0.701 |
|          MinEpRet |          -0.528 |
|     AverageEpCost |            48.8 |
|         StdEpCost |            70.5 |
|         MaxEpCost |             181 |
|         MinEpCost |               0 |
|             EpLen |           1e+03 |
|      AverageVVals |           -3.88 |
|          StdVVals |            4.62 |
|          MaxVVals |            2.05 |
|          MinVVals |           -19.3 |
| TotalEnvInteracts |           2e+04 |
|            LossPi |         9.2e+10 |
|       DeltaLossPi |        -9.2e+10 |
|             LossV |            55.6 |
|        DeltaLossV |           -45.1 |
|            LossDC |               0 |
|       DeltaLossDC |               0 |
|                KL |         0.00712 |
|              Time |              43 |
---------------------------------------
context sample:  tensor(0)
LABEL:  tensor([0])
GROUND TRUTH:  tensor([[0.]])
context sample:  tensor(1)
LABEL:  tensor([0])
GROUND TRUTH:  tensor([[1.]])
context sample:  tensor(3)
LABEL:  tensor([0])
GROUND TRUTH:  tensor([[3.]])
context sample:  tensor(0)
LABEL:  tensor([8])
GROUND TRUTH:  tensor([[0.]])
context sample:  tensor(4)
LABEL:  tensor([4])
GROUND TRUTH:  tensor([[4.]])
policy pull
value function pull
logging changes
---------------------------------------
|             Epoch |               4 |
|      AverageEpRet |         -0.0727 |
|          StdEpRet |            1.26 |
|          MaxEpRet |            1.72 |
|          MinEpRet |           -1.96 |
|     AverageEpCost |            84.6 |
|         StdEpCost |              84 |
|         MaxEpCost |             223 |
|         MinEpCost |               0 |
|             EpLen |           1e+03 |
|      AverageVVals |           -4.24 |
|          StdVVals |            4.57 |
|          MaxVVals |           0.633 |
|          MinVVals |           -19.3 |
| TotalEnvInteracts |         2.5e+04 |
|            LossPi |        1.29e+17 |
|       DeltaLossPi |       -1.29e+17 |
|             LossV |            90.4 |
|        DeltaLossV |           -74.8 |
|            LossDC |               0 |
|       DeltaLossDC |               0 |
|                KL |         0.00289 |
|              Time |            53.7 |
---------------------------------------
context sample:  tensor(4)
LABEL:  tensor([3])
GROUND TRUTH:  tensor([[4.]])
context sample:  tensor(2)
LABEL:  tensor([6])
GROUND TRUTH:  tensor([[2.]])
context sample:  tensor(7)
LABEL:  tensor([7])
GROUND TRUTH:  tensor([[7.]])
context sample:  tensor(4)
LABEL:  tensor([2])
GROUND TRUTH:  tensor([[4.]])
context sample:  tensor(4)
LABEL:  tensor([1])
GROUND TRUTH:  tensor([[4.]])
policy pull
value function pull
logging changes
---------------------------------------
|             Epoch |               5 |
|      AverageEpRet |           0.847 |
|          StdEpRet |            3.08 |
|          MaxEpRet |            6.66 |
|          MinEpRet |           -2.29 |
|     AverageEpCost |             9.2 |
|         StdEpCost |            18.4 |
|         MaxEpCost |              46 |
|         MinEpCost |               0 |
|             EpLen |           1e+03 |
|      AverageVVals |          -0.524 |
|          StdVVals |            3.76 |
|          MaxVVals |           0.784 |
|          MinVVals |           -26.2 |
| TotalEnvInteracts |           3e+04 |
|            LossPi |        9.22e+04 |
|       DeltaLossPi |       -9.22e+04 |
|             LossV |            14.8 |
|        DeltaLossV |           -11.6 |
|            LossDC |               0 |
|       DeltaLossDC |               0 |
|                KL |         0.00209 |
|              Time |            64.4 |
---------------------------------------
context sample:  tensor(5)
LABEL:  tensor([5])
GROUND TRUTH:  tensor([[5.]])
context sample:  tensor(0)
LABEL:  tensor([8])
GROUND TRUTH:  tensor([[0.]])
context sample:  tensor(5)
LABEL:  tensor([1])
GROUND TRUTH:  tensor([[5.]])
context sample:  tensor(3)
LABEL:  tensor([7])
GROUND TRUTH:  tensor([[3.]])
context sample:  tensor(8)
LABEL:  tensor([0])
GROUND TRUTH:  tensor([[8.]])
policy pull
value function pull
logging changes
---------------------------------------
|             Epoch |               6 |
|      AverageEpRet |          -0.482 |
|          StdEpRet |           0.736 |
|          MaxEpRet |           0.221 |
|          MinEpRet |           -1.86 |
|     AverageEpCost |            36.4 |
|         StdEpCost |            44.9 |
|         MaxEpCost |              99 |
|         MinEpCost |               0 |
|             EpLen |           1e+03 |
|      AverageVVals |          -0.743 |
|          StdVVals |           0.701 |
|          MaxVVals |           0.353 |
|          MinVVals |           -9.61 |
| TotalEnvInteracts |         3.5e+04 |
|            LossPi |        5.55e+09 |
|       DeltaLossPi |       -5.55e+09 |
|             LossV |            21.5 |
|        DeltaLossV |           -11.5 |
|            LossDC |               0 |
|       DeltaLossDC |               0 |
|                KL |         0.00121 |
|              Time |            74.8 |
---------------------------------------
context sample:  tensor(8)
LABEL:  tensor([8])
GROUND TRUTH:  tensor([[8.]])
context sample:  tensor(6)
LABEL:  tensor([3])
GROUND TRUTH:  tensor([[6.]])
context sample:  tensor(6)
LABEL:  tensor([9])
GROUND TRUTH:  tensor([[6.]])
context sample:  tensor(7)
LABEL:  tensor([2])
GROUND TRUTH:  tensor([[7.]])
context sample:  tensor(8)
LABEL:  tensor([0])
GROUND TRUTH:  tensor([[8.]])
policy pull
value function pull
logging changes
---------------------------------------
|             Epoch |               7 |
|      AverageEpRet |          0.0766 |
|          StdEpRet |            1.54 |
|          MaxEpRet |            3.08 |
|          MinEpRet |           -1.11 |
|     AverageEpCost |            20.4 |
|         StdEpCost |            25.2 |
|         MaxEpCost |              56 |
|         MinEpCost |               0 |
|             EpLen |           1e+03 |
|      AverageVVals |           -2.23 |
|          StdVVals |            2.02 |
|          MaxVVals |             1.2 |
|          MinVVals |           -10.6 |
| TotalEnvInteracts |           4e+04 |
|            LossPi |        2.15e+06 |
|       DeltaLossPi |       -2.15e+06 |
|             LossV |            10.8 |
|        DeltaLossV |           -8.08 |
|            LossDC |               0 |
|       DeltaLossDC |               0 |
|                KL |          0.0012 |
|              Time |            85.5 |
---------------------------------------
context sample:  tensor(8)
LABEL:  tensor([8])
GROUND TRUTH:  tensor([[8.]])
context sample:  tensor(0)
LABEL:  tensor([1])
GROUND TRUTH:  tensor([[0.]])
context sample:  tensor(0)
LABEL:  tensor([6])
GROUND TRUTH:  tensor([[0.]])
context sample:  tensor(2)
LABEL:  tensor([4])
GROUND TRUTH:  tensor([[2.]])
context sample:  tensor(9)
LABEL:  tensor([9])
GROUND TRUTH:  tensor([[9.]])
policy pull
value function pull
logging changes
---------------------------------------
|             Epoch |               8 |
|      AverageEpRet |          -0.951 |
|          StdEpRet |           0.474 |
|          MaxEpRet |          -0.125 |
|          MinEpRet |           -1.55 |
|     AverageEpCost |            72.6 |
|         StdEpCost |            65.6 |
|         MaxEpCost |             172 |
|         MinEpCost |               0 |
|             EpLen |           1e+03 |
|      AverageVVals |          -0.483 |
|          StdVVals |            1.69 |
|          MaxVVals |            1.45 |
|          MinVVals |           -10.8 |
| TotalEnvInteracts |         4.5e+04 |
|            LossPi |        3.92e+09 |
|       DeltaLossPi |       -3.92e+09 |
|             LossV |            39.8 |
|        DeltaLossV |           -33.7 |
|            LossDC |               0 |
|       DeltaLossDC |               0 |
|                KL |         0.00242 |
|              Time |            96.2 |
---------------------------------------
context sample:  tensor(8)
LABEL:  tensor([5])
GROUND TRUTH:  tensor([[8.]])
context sample:  tensor(8)
LABEL:  tensor([0])
GROUND TRUTH:  tensor([[8.]])
context sample:  tensor(0)
LABEL:  tensor([2])
GROUND TRUTH:  tensor([[0.]])
context sample:  tensor(5)
LABEL:  tensor([7])
GROUND TRUTH:  tensor([[5.]])
context sample:  tensor(7)
LABEL:  tensor([0])
GROUND TRUTH:  tensor([[7.]])
policy pull
value function pull
Discriminator Update!
s diff:  tensor([[[-2.4325e+00,  5.7998e+00,  0.0000e+00,  ...,  1.2472e-01,
           2.5870e-02,  0.0000e+00],
         [ 5.7884e+00,  1.1030e+01,  0.0000e+00,  ..., -3.4048e-01,
          -7.5866e-02,  0.0000e+00],
         [-1.9297e-01, -1.7173e+01,  0.0000e+00,  ...,  1.5846e-01,
           3.3728e-02,  0.0000e+00],
         ...,
         [-3.7165e+00,  2.4453e+01,  0.0000e+00,  ..., -3.8120e-01,
           1.8973e-01,  0.0000e+00],
         [-1.9504e-01,  4.3181e-01,  0.0000e+00,  ...,  1.0154e-01,
          -1.5013e-01,  0.0000e+00],
         [ 5.8440e+00,  2.1181e+00,  0.0000e+00,  ..., -2.2251e-02,
           5.4854e-02,  0.0000e+00]],

        [[ 3.3267e+00,  1.0000e+01,  0.0000e+00,  ..., -1.7666e-01,
           3.4894e-02,  0.0000e+00],
         [-5.9351e+00, -1.7069e+01,  0.0000e+00,  ...,  4.3491e-02,
           1.4134e-01,  0.0000e+00],
         [ 1.0746e+00,  6.2285e+00,  0.0000e+00,  ..., -4.8877e-01,
          -3.8226e-03,  0.0000e+00],
         ...,
         [-4.0409e-01,  2.6994e+00,  0.0000e+00,  ...,  2.2689e-01,
           9.3332e-02,  0.0000e+00],
         [ 5.3860e+00, -1.1872e+01,  0.0000e+00,  ...,  1.2872e-01,
           3.8406e-02,  0.0000e+00],
         [-4.5910e+00,  2.2117e+01,  0.0000e+00,  ..., -6.1779e-01,
          -6.8159e-03,  0.0000e+00]],

        [[ 3.2860e+00,  1.2495e+01,  0.0000e+00,  ..., -2.0289e-01,
           4.7784e-02,  0.0000e+00],
         [-2.1786e-01, -1.5988e+01,  0.0000e+00,  ...,  1.5422e-01,
           2.4986e-02,  0.0000e+00],
         [-1.8067e+00, -2.4421e+00,  0.0000e+00,  ..., -1.6557e-01,
          -3.2681e-02,  0.0000e+00],
         ...,
         [-1.1100e-01, -2.1425e+01,  0.0000e+00,  ...,  5.8745e-02,
          -1.2478e-02,  0.0000e+00],
         [ 6.1345e+00,  3.6067e+00,  0.0000e+00,  ..., -1.6071e-01,
           1.8971e-02,  0.0000e+00],
         [-6.0395e+00,  1.5859e+01,  0.0000e+00,  ...,  1.0762e-01,
          -1.9781e-02,  0.0000e+00]],

        ...,

        [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
           0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
           0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
           0.0000e+00,  0.0000e+00],
         ...,
         [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
           0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
           0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
           0.0000e+00,  0.0000e+00]],

        [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
           0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
           0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
           0.0000e+00,  0.0000e+00],
         ...,
         [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
           0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
           0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
           0.0000e+00,  0.0000e+00]],

        [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
           0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
           0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
           0.0000e+00,  0.0000e+00],
         ...,
         [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
           0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
           0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
           0.0000e+00,  0.0000e+00]]])
s diff shape:  tensor([[[-2.4325e+00,  5.7998e+00,  0.0000e+00,  ...,  1.2472e-01,
           2.5870e-02,  0.0000e+00],
         [ 5.7884e+00,  1.1030e+01,  0.0000e+00,  ..., -3.4048e-01,
          -7.5866e-02,  0.0000e+00],
         [-1.9297e-01, -1.7173e+01,  0.0000e+00,  ...,  1.5846e-01,
           3.3728e-02,  0.0000e+00],
         ...,
         [-3.7165e+00,  2.4453e+01,  0.0000e+00,  ..., -3.8120e-01,
           1.8973e-01,  0.0000e+00],
         [-1.9504e-01,  4.3181e-01,  0.0000e+00,  ...,  1.0154e-01,
          -1.5013e-01,  0.0000e+00],
         [ 5.8440e+00,  2.1181e+00,  0.0000e+00,  ..., -2.2251e-02,
           5.4854e-02,  0.0000e+00]],

        [[ 3.3267e+00,  1.0000e+01,  0.0000e+00,  ..., -1.7666e-01,
           3.4894e-02,  0.0000e+00],
         [-5.9351e+00, -1.7069e+01,  0.0000e+00,  ...,  4.3491e-02,
           1.4134e-01,  0.0000e+00],
         [ 1.0746e+00,  6.2285e+00,  0.0000e+00,  ..., -4.8877e-01,
          -3.8226e-03,  0.0000e+00],
         ...,
         [-4.0409e-01,  2.6994e+00,  0.0000e+00,  ...,  2.2689e-01,
           9.3332e-02,  0.0000e+00],
         [ 5.3860e+00, -1.1872e+01,  0.0000e+00,  ...,  1.2872e-01,
           3.8406e-02,  0.0000e+00],
         [-4.5910e+00,  2.2117e+01,  0.0000e+00,  ..., -6.1779e-01,
          -6.8159e-03,  0.0000e+00]],

        [[ 3.2860e+00,  1.2495e+01,  0.0000e+00,  ..., -2.0289e-01,
           4.7784e-02,  0.0000e+00],
         [-2.1786e-01, -1.5988e+01,  0.0000e+00,  ...,  1.5422e-01,
           2.4986e-02,  0.0000e+00],
         [-1.8067e+00, -2.4421e+00,  0.0000e+00,  ..., -1.6557e-01,
          -3.2681e-02,  0.0000e+00],
         ...,
         [-1.1100e-01, -2.1425e+01,  0.0000e+00,  ...,  5.8745e-02,
          -1.2478e-02,  0.0000e+00],
         [ 6.1345e+00,  3.6067e+00,  0.0000e+00,  ..., -1.6071e-01,
           1.8971e-02,  0.0000e+00],
         [-6.0395e+00,  1.5859e+01,  0.0000e+00,  ...,  1.0762e-01,
          -1.9781e-02,  0.0000e+00]],

        ...,

        [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
           0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
           0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
           0.0000e+00,  0.0000e+00],
         ...,
         [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
           0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
           0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
           0.0000e+00,  0.0000e+00]],

        [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
           0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
           0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
           0.0000e+00,  0.0000e+00],
         ...,
         [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
           0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
           0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
           0.0000e+00,  0.0000e+00]],

        [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
           0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
           0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
           0.0000e+00,  0.0000e+00],
         ...,
         [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
           0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
           0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
           0.0000e+00,  0.0000e+00]]])
LABEL:  tensor([6, 3, 7, 3, 6, 1, 6, 9, 4, 7, 9, 9, 1, 5, 0, 2, 6, 5, 8, 1, 7, 0, 0, 8,
        3, 4, 7, 9, 3, 7, 1, 6, 7, 1, 8, 3, 3, 2, 5, 7, 8, 0, 1, 6, 8, 6, 2, 0,
        6, 3])
GROUND TRUTH:  tensor([8., 8., 0., 5., 7., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.])
LABEL:  tensor([2, 4, 2, 0, 2, 5, 2, 2, 2, 0, 1, 6, 2, 3, 1, 6, 8, 1, 6, 0, 4, 7, 0, 3,
        7, 0, 8, 6, 5, 7, 3, 5, 5, 8, 8, 4, 5, 0, 9, 9, 3, 9, 3, 0, 3, 7, 1, 0,
        3, 2])
GROUND TRUTH:  tensor([8., 8., 0., 5., 7., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.])
LABEL:  tensor([3, 4, 0, 5, 2, 9, 4, 7, 7, 1, 7, 1, 3, 7, 2, 1, 7, 5, 1, 3, 2, 3, 7, 4,
        9, 4, 6, 9, 7, 6, 0, 9, 0, 8, 4, 1, 6, 2, 3, 7, 5, 6, 2, 1, 7, 7, 8, 5,
        6, 1])
GROUND TRUTH:  tensor([8., 8., 0., 5., 7., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.])
LABEL:  tensor([1, 6, 6, 4, 6, 6, 4, 1, 8, 4, 9, 4, 6, 1, 7, 3, 0, 5, 8, 3, 5, 1, 8, 7,
        3, 5, 5, 1, 2, 1, 3, 0, 8, 2, 5, 1, 7, 2, 0, 7, 1, 9, 7, 3, 8, 6, 7, 6,
        7, 2])
GROUND TRUTH:  tensor([8., 8., 0., 5., 7., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.])
LABEL:  tensor([5, 9, 3, 0, 8, 8, 5, 2, 3, 7, 1, 0, 0, 1, 3, 7, 5, 1, 2, 5, 9, 0, 0, 7,
        1, 3, 4, 6, 9, 5, 5, 8, 1, 9, 0, 6, 6, 0, 1, 1, 9, 7, 1, 3, 1, 8, 6, 5,
        2, 0])
GROUND TRUTH:  tensor([8., 8., 0., 5., 7., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.])
LABEL:  tensor([2, 9, 1, 1, 5, 8, 8, 2, 4, 4, 8, 5, 7, 2, 0, 6, 6, 6, 3, 1, 7, 2, 1, 7,
        0, 2, 9, 6, 4, 3, 4, 7, 8, 5, 8, 0, 1, 3, 1, 1, 9, 9, 0, 6, 0, 4, 3, 2,
        7, 0])
GROUND TRUTH:  tensor([8., 8., 0., 5., 7., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.])
LABEL:  tensor([5, 0, 9, 8, 4, 9, 9, 6, 5, 5, 6, 1, 2, 9, 3, 4, 2, 0, 6, 9, 4, 6, 6, 6,
        4, 4, 4, 3, 6, 5, 9, 8, 6, 4, 6, 9, 0, 9, 0, 1, 0, 6, 0, 8, 7, 3, 1, 7,
        0, 3])
GROUND TRUTH:  tensor([8., 8., 0., 5., 7., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.])
LABEL:  tensor([1, 2, 0, 8, 9, 1, 7, 8, 7, 6, 2, 0, 5, 7, 7, 3, 1, 8, 6, 2, 8, 2, 5, 7,
        4, 7, 6, 0, 8, 2, 7, 1, 1, 7, 8, 0, 3, 4, 1, 2, 5, 4, 0, 1, 9, 1, 6, 9,
        2, 4])
GROUND TRUTH:  tensor([8., 8., 0., 5., 7., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.])
LABEL:  tensor([3, 5, 5, 4, 1, 6, 0, 0, 6, 3, 5, 1, 5, 2, 2, 8, 6, 6, 0, 2, 4, 5, 4, 0,
        0, 0, 7, 0, 0, 0, 7, 8, 7, 3, 1, 6, 7, 7, 2, 5, 2, 8, 5, 5, 4, 5, 9, 9,
        4, 1])
GROUND TRUTH:  tensor([8., 8., 0., 5., 7., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.])
LABEL:  tensor([9, 0, 1, 3, 9, 0, 3, 7, 0, 1, 4, 5, 5, 4, 1, 0, 0, 9, 0, 7, 7, 7, 0, 1,
        8, 5, 6, 8, 3, 0, 4, 3, 9, 5, 6, 9, 6, 2, 7, 9, 1, 0, 2, 1, 1, 1, 3, 0,
        4, 8])
GROUND TRUTH:  tensor([8., 8., 0., 5., 7., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.])
LABEL:  tensor([1, 2, 4, 4, 0, 9, 0, 7, 8, 9, 1, 6, 3, 5, 9, 2, 6, 5, 0, 8, 4, 5, 9, 0,
        5, 8, 0, 4, 7, 3, 0, 3, 9, 3, 9, 4, 4, 0, 6, 3, 8, 0, 9, 6, 9, 2, 9, 8,
        4, 7])
GROUND TRUTH:  tensor([8., 8., 0., 5., 7., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.])
LABEL:  tensor([5, 3, 0, 8, 2, 7, 2, 5, 5, 5, 7, 0, 7, 2, 8, 1, 8, 3, 1, 4, 9, 1, 9, 5,
        0, 8, 9, 1, 4, 5, 9, 0, 3, 7, 6, 3, 9, 2, 0, 0, 2, 0, 9, 5, 6, 5, 6, 7,
        7, 2])
GROUND TRUTH:  tensor([8., 8., 0., 5., 7., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.])
logging changes
---------------------------------------
|             Epoch |               9 |
|      AverageEpRet |           0.147 |
|          StdEpRet |            1.15 |
|          MaxEpRet |            2.09 |
|          MinEpRet |           -0.96 |
|     AverageEpCost |            24.8 |
|         StdEpCost |            30.5 |
|         MaxEpCost |              67 |
|         MinEpCost |               0 |
|             EpLen |           1e+03 |
|      AverageVVals |           -1.17 |
|          StdVVals |            1.76 |
|          MaxVVals |            3.03 |
|          MinVVals |           -12.5 |
| TotalEnvInteracts |           5e+04 |
|            LossPi |        2.23e+06 |
|       DeltaLossPi |       -2.23e+06 |
|             LossV |            7.93 |
|        DeltaLossV |           -4.26 |
|            LossDC |            2.27 |
|       DeltaLossDC |          -0.275 |
|                KL |        0.000695 |
|              Time |             107 |
---------------------------------------
context sample:  tensor(9)
LABEL:  tensor([1])
GROUND TRUTH:  tensor([[9.]])
context sample:  tensor(8)
LABEL:  tensor([5])
GROUND TRUTH:  tensor([[8.]])
context sample:  tensor(8)
LABEL:  tensor([6])
GROUND TRUTH:  tensor([[8.]])
context sample:  tensor(9)
LABEL:  tensor([8])
GROUND TRUTH:  tensor([[9.]])
context sample:  tensor(8)
LABEL:  tensor([9])
GROUND TRUTH:  tensor([[8.]])
policy pull
value function pull
logging changes
---------------------------------------
|             Epoch |              10 |
|      AverageEpRet |           0.211 |
|          StdEpRet |            0.78 |
|          MaxEpRet |            1.36 |
|          MinEpRet |          -0.974 |
|     AverageEpCost |              30 |
|         StdEpCost |            34.4 |
|         MaxEpCost |              94 |
|         MinEpCost |               0 |
|             EpLen |           1e+03 |
|      AverageVVals |           -1.79 |
|          StdVVals |            3.37 |
|          MaxVVals |           0.945 |
|          MinVVals |           -16.3 |
| TotalEnvInteracts |         5.5e+04 |
|            LossPi |        1.82e+05 |
|       DeltaLossPi |       -1.82e+05 |
|             LossV |            20.5 |
|        DeltaLossV |           -12.4 |
|            LossDC |               0 |
|       DeltaLossDC |               0 |
|                KL |        5.51e-05 |
|              Time |             117 |
---------------------------------------
context sample:  tensor(0)
LABEL:  tensor([1])
GROUND TRUTH:  tensor([[0.]])
context sample:  tensor(8)
LABEL:  tensor([5])
GROUND TRUTH:  tensor([[8.]])
context sample:  tensor(4)
LABEL:  tensor([1])
GROUND TRUTH:  tensor([[4.]])
context sample:  tensor(4)
LABEL:  tensor([9])
GROUND TRUTH:  tensor([[4.]])
context sample:  tensor(6)
LABEL:  tensor([1])
GROUND TRUTH:  tensor([[6.]])
policy pull
value function pull
logging changes
---------------------------------------
|             Epoch |              11 |
|      AverageEpRet |          -0.261 |
|          StdEpRet |           0.771 |
|          MaxEpRet |           0.859 |
|          MinEpRet |            -1.2 |
|     AverageEpCost |             126 |
|         StdEpCost |             106 |
|         MaxEpCost |             236 |
|         MinEpCost |               0 |
|             EpLen |           1e+03 |
|      AverageVVals |           -1.16 |
|          StdVVals |           0.221 |
|          MaxVVals |          -0.941 |
|          MinVVals |           -4.58 |
| TotalEnvInteracts |           6e+04 |
|            LossPi |        7.24e+10 |
|       DeltaLossPi |       -7.24e+10 |
|             LossV |            69.1 |
|        DeltaLossV |             -48 |
|            LossDC |               0 |
|       DeltaLossDC |               0 |
|                KL |        0.000849 |
|              Time |             132 |
---------------------------------------
context sample:  tensor(6)
LABEL:  tensor([4])
GROUND TRUTH:  tensor([[6.]])
context sample:  tensor(6)
LABEL:  tensor([1])
GROUND TRUTH:  tensor([[6.]])
context sample:  tensor(9)
LABEL:  tensor([0])
GROUND TRUTH:  tensor([[9.]])
context sample:  tensor(1)
LABEL:  tensor([7])
GROUND TRUTH:  tensor([[1.]])
context sample:  tensor(2)
LABEL:  tensor([8])
GROUND TRUTH:  tensor([[2.]])
policy pull
value function pull
logging changes
---------------------------------------
|             Epoch |              12 |
|      AverageEpRet |          -0.237 |
|          StdEpRet |           0.471 |
|          MaxEpRet |           0.419 |
|          MinEpRet |          -0.769 |
|     AverageEpCost |            58.8 |
|         StdEpCost |            83.9 |
|         MaxEpCost |             224 |
|         MinEpCost |               0 |
|             EpLen |           1e+03 |
|      AverageVVals |           -4.72 |
|          StdVVals |               5 |
|          MaxVVals |            3.31 |
|          MinVVals |             -20 |
| TotalEnvInteracts |         6.5e+04 |
|            LossPi |        6.84e+11 |
|       DeltaLossPi |       -6.84e+11 |
|             LossV |              59 |
|        DeltaLossV |           -46.8 |
|            LossDC |               0 |
|       DeltaLossDC |               0 |
|                KL |        0.000468 |
|              Time |             147 |
---------------------------------------
context sample:  tensor(6)
LABEL:  tensor([3])
GROUND TRUTH:  tensor([[6.]])
context sample:  tensor(6)
LABEL:  tensor([5])
GROUND TRUTH:  tensor([[6.]])
context sample:  tensor(3)
LABEL:  tensor([0])
GROUND TRUTH:  tensor([[3.]])
context sample:  tensor(7)
LABEL:  tensor([2])
GROUND TRUTH:  tensor([[7.]])
context sample:  tensor(0)
LABEL:  tensor([8])
GROUND TRUTH:  tensor([[0.]])
policy pull
value function pull
logging changes
---------------------------------------
|             Epoch |              13 |
|      AverageEpRet |            1.17 |
|          StdEpRet |           0.693 |
|          MaxEpRet |            2.27 |
|          MinEpRet |            0.13 |
|     AverageEpCost |            44.2 |
|         StdEpCost |              55 |
|         MaxEpCost |             141 |
|         MinEpCost |               0 |
|             EpLen |           1e+03 |
|      AverageVVals |           -2.39 |
|          StdVVals |            2.86 |
|          MaxVVals |             1.4 |
|          MinVVals |           -12.4 |
| TotalEnvInteracts |           7e+04 |
|            LossPi |        4.37e+08 |
|       DeltaLossPi |       -4.37e+08 |
|             LossV |            22.6 |
|        DeltaLossV |             -17 |
|            LossDC |               0 |
|       DeltaLossDC |               0 |
|                KL |        0.000818 |
|              Time |             159 |
---------------------------------------
context sample:  tensor(7)
LABEL:  tensor([5])
GROUND TRUTH:  tensor([[7.]])
context sample:  tensor(4)
Traceback (most recent call last):
  File "/home/tyna/Documents/safe-experts/algos/train_expert_valor_penalized.py", line 336, in <module>
    valor_penalized(lambda: gym.make(args.env), actor_critic=ActorCritic, ac_kwargs=dict(hidden_dims=[args.hid] * args.l),
  File "/home/tyna/Documents/safe-experts/algos/train_expert_valor_penalized.py", line 219, in valor_penalized
    a, _, logp_t, v_t = ac(concat_obs)
  File "/home/tyna/.local/lib/python3.8/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/tyna/Documents/safe-experts/algos/neural_nets.py", line 169, in forward
    pi, logp, logp_pi = self.pi(x, a)
  File "/home/tyna/.local/lib/python3.8/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/tyna/Documents/safe-experts/algos/neural_nets.py", line 92, in forward
    logp_pi = policy.log_prob(pi).sum(dim=1)
  File "/home/tyna/.local/lib/python3.8/site-packages/torch/distributions/normal.py", line 76, in log_prob
    return -((value - self.loc) ** 2) / (2 * var) - log_scale - math.log(math.sqrt(2 * math.pi))
KeyboardInterrupt
